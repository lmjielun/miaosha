<!DOCTYPE html>
<html>

<head>
	<meta charset="utf-8" />
	<meta http-equiv="X-UA-Compatible" content="IE=EmulateIE7" />
	<title>**电商秒杀-正品秒杀！</title>
	<link rel="icon" href="/assets/img/favicon.ico">
    <link rel="stylesheet" type="text/css" href="../static/css/webbase.css" />
    <link rel="stylesheet" type="text/css" href="../static/css/widget-jquery.autocomplete.css" />
	<link rel="stylesheet" type="text/css" href="../static/css/pages-seckill-index.css">
</head>

<body>
	<!-- 头部栏位 -->
	<!--页面顶部-->
<div id="nav-bottom">
	<!--顶部-->
	<div class="nav-top">
		<div class="top">
			<div class="py-container">
				<div class="shortcut">
					<ul class="fl">
						<li class="f-item">**电商欢迎您！</li>
						<li class="f-item">请<a href="login.html" target="_blank">登录</a>　<span><a href="register.html" target="_blank">免费注册</a></span></li>
					</ul>
					<ul class="fr">
						<li class="f-item">我的订单</li>
						<li class="f-item space"></li>
						<li class="f-item"><a href="seckillOrder.html" target="_blank">我的**电商</a></li>
						<li class="f-item space"></li>
						<li class="f-item">**电商会员</li>
						<li class="f-item space"></li>
						<li class="f-item">企业采购</li>
						<li class="f-item space"></li>
						<li class="f-item">关注**电商</li>
						<li class="f-item space"></li>
						<li class="f-item" id="service">
							<span>客户服务</span>
							<ul class="service">
								<li><a href="cooperation.html" target="_blank">合作招商</a></li>
								<li><a href="shoplogin.html" target="_blank">商家后台</a></li>
								<li><a href="cooperation.html" target="_blank">合作招商</a></li>
								<li><a href="#">商家后台</a></li>
							</ul>
						</li>
						<li class="f-item space"></li>
						<li class="f-item">网站导航</li>
					</ul>
				</div>
			</div>
		</div>

		<!--头部-->
		<div class="header">
			<div class="py-container">
				<div class="yui3-g Logo">
					<div class="yui3-u Left logoArea">
						<a class="logo-bd" title="**电商" href="JD-index.html" target="_blank"></a>
					</div>
					<div class="yui3-u Center searchArea">
						<div class="search">
							<form action="" class="sui-form form-inline">
								<!--searchAutoComplete-->
								<div class="input-append">
									<input type="text" id="autocomplete" type="text" class="input-error input-xxlarge" />
									<button class="sui-btn btn-xlarge btn-danger" type="button">搜索</button>
								</div>
							</form>
						</div>
						<div class="hotwords">
							<ul>
								<li class="f-item">**电商首发</li>
								<li class="f-item">亿元优惠</li>
								<li class="f-item">9.9元团购</li>
								<li class="f-item">每满99减30</li>
								<li class="f-item">亿元优惠</li>
								<li class="f-item">9.9元团购</li>
								<li class="f-item">办公用品</li>

							</ul>
						</div>
					</div>
					<div class="yui3-u Right shopArea">
						<div class="fr shopcar">
							<div class="show-shopcar" id="shopcar">
								<span class="car"></span>
								<a class="sui-btn btn-default btn-xlarge" href="cart.html" target="_blank">
									<span>我的购物车</span>
									<i class="shopnum">0</i>
								</a>
								<div class="clearfix shopcarlist" id="shopcarlist" style="display:none">
									<p>"啊哦，你的购物车还没有商品哦！"</p>
									<p>"啊哦，你的购物车还没有商品哦！"</p>
								</div>
							</div>
						</div>
					</div>
				</div>

				<div class="yui3-g NavList">
					<div class="yui3-u Left all-sort">
						<h4>全部商品分类</h4>
					</div>
					<div class="yui3-u Center navArea">
						<ul class="nav">
							<li class="f-item">服装城</li>
							<li class="f-item">美妆馆</li>
							<li class="f-item">品优超市</li>
							<li class="f-item">全球购</li>
							<li class="f-item">闪购</li>
							<li class="f-item">团购</li>
							<li class="f-item">有趣</li>
							<li class="f-item"><a href="seckill-index.html" target="_blank">秒杀</a></li>
						</ul>
					</div>
					<div class="yui3-u Right"></div>
				</div>
			</div>
		</div>
	</div>
</div>

<script type="text/javascript" src="../static/js/plugins/jquery/jquery.min.js"></script>
<script type="text/javascript">
$(function(){
	$("#service").hover(function(){
		$(".service").show();
	},function(){
		$(".service").hide();
	});
	$("#shopcar").hover(function(){
		$("#shopcarlist").show();
	},function(){
		$("#shopcarlist").hide();
	});

})
</script>
<script type="text/javascript" src="../static/js/plugins/sui/sui.min.js"></script>
<script type="text/javascript" src="../static/js/plugins/widget/jquery.autocomplete.js"></script>
<script type="text/javascript" src="../static/js/plugins/widget/nav.js"></script>
<script type="text/javascript" src="../static/js/plugins/pages/seckill-index.js"></script>
<script>
	   $(function(){
		   $("#code").hover(function(){
			   $(".erweima").show();
		   },function(){
			   $(".erweima").hide();
		   });
	   })
	</script>
</body>

	<div class="py-container index" id="app">
		<!--banner-->
		<div class="banner">
			<img src="../static/img/_/banner.png" class="img-responsive" alt="">
		</div>
		<!--商品列表-->
		<!--{{goodsList}}-->
		<div class="goods-list">
			<ul class="seckill" id="seckill">
				<li class="seckill-item"  v-for="(goods,goodsIndex) in goodsList">
					<!--这里传递goods的id-->
					<div class="pic"  @click="gotoItem(goods.id)">
						<img src="../static/img/_/list.jpg" alt=''  >
					</div>
					<!--商品的标题-->
					<div class="intro"><span>{{goods.title}}</span></div>
					<!--商品的原价和现价-->
					<div class='price'><b class='sec-price'>￥{{goods.costPrice}}</b><b class='ever-price'>￥{{goods.price}}</b></div>
					<div class='num'>
						<!--显示剩余百分数 （（商品数量-商品剩余数量）/ 商品数量）*100 -->
						<div>{{((goods.num - goods.stockCount)/goods.num)*100}}%</div>
						<div class='progress'>
							<div class='sui-progress progress-danger'>
								<!--显示百分比条 （（商品数量-商品剩余数量）/ 商品数量）*100 + '%'  -->
								<span :style="'width:'+(((goods.num-goods.stockCount)/goods.num)*100)+'%'" class='bar'></span>
							</div>
						</div>
						<!--剩余多少件-->
						<div>剩余<b class='owned'>{{goods.stockCount}}</b>件</div>
					</div>
					<!--href='seckill-item.html' -->
					<a class='sui-btn btn-block btn-buy' @click="gotoItem(goods.id)">立即抢购</a>
				</li>
			</ul>
		</div>
	</div>


<!-- 底部栏位 -->
<!--页面底部-->
<div class="clearfix footer">
	**********页面底部***********
</div>
<!--页面底部END-->

<script src="../static/js/plugins/vue/vue.min.js"></script>
<script src="../static/js/plugins/vue/axios.min.js"></script>
<script src="../static/js/plugins/jquery/jquery.cookie.js"></script>
<script src="../static/js/plugins/util.js"></script>
<!--vue-->
<script>
	var baseUrl = "http://localhost:10010/api/item/";
	var app = new Vue({
		el:"#app",
		data:{
		    /*秒杀商品的集合*/
		    goodsList:[],
			/*秒杀商品对象*/
			seckillGoods:{},
		},
        created: function (){
		    /*加上秒杀商品集合*/
			this.loadGoodsList();
		},
        methods: {
		    /*加载秒杀商品列表*/
            loadGoodsList:function () {
                //发送请求获取数据
                axios.get(baseUrl+'/seckill/list').then(function (response) {
                    //将数据绑定到变量中，并页面显示
                    app.goodsList = response.data;
                });
            },

            /*根据id获取秒杀商品对象*/
            gotoItem:function (goodsId) {
                axios.get(baseUrl+'/seckill/'+goodsId).then(function (response) {
                    /*将获取到的商品对象，赋值给app的秒杀商品对象*/
                    app.seckillGoods = response.data;
                    /*将获取到的对象，使用html传递参数到itme.html页面*/
                    location.href = "seckill-item.html?seckillGoods="+app.seckillGoods.id;
                });
            }

		}
    })
</script>
<!--加载完商品后，那么有个问题，后台是每30s从redis获取一次数据，那你前台页面，什么时候刷新？肯定不能手动刷新，
	所以加个定时器，每3秒刷新一次前台页面-->
<script type="text/javascript">
    var int=window.setInterval("clock()",3000);
    function clock() {
        //alert("刷新页面")
        app.loadGoodsList();//每隔3s加载商品的列表页面
    }
</script>

</html>